@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model List<POE_MVC_part1.Models.Claims>
<link rel="stylesheet" href="~/css/StyleSheet.css" asp-append-version="true" />
@Html.Partial("_NavigationBars")

<div class="pcMessage">
    <h1>Claims Awaiting Approval</h1>
    <p>The following claims have been submitted by lecturers. You can either pre-approve them or flag them for review.</p>

    <div class="back_link">
        <a href="@Url.Action("Program_Coordinator", "Users")">
            &larr; Back to Programme Coordinator Dashboard
        </a>
    </div>

    @if (TempData["Message"] != null)
    {
        <p class="alert">@TempData["Message"]</p>
    }
</div>
<table class="View-preApprove" style="border:solid;">
    <thead>
        <tr>
            <th>Claim No</th>
            <th>Lecturer Name</th>
            <th>Employee ID</th>
            <th>Module</th>
            <th>Sessions</th>
            <th>Hourly Rate</th>
            <th>Total</th>
            <th>Status</th>
            <th>Decision</th>
            <th>Download</th> <!-- New column for download button -->
        </tr>
    </thead>

    <tbody>
        @foreach (var claim in Model)
        {
            <tr>
                <td>@claim.Claim_Id</td>
                <td>@claim.name</td>
                <td>@claim.employeenum</td>
                <td>@claim.module_name</td>
                <td>@claim.number_of_sssions</td>
                <td>@claim.hourly_rate.ToString("R")</td>
                <td>@claim.TotalAmount.ToString("R")</td>

                <td class="status @claim.ClaimStatus.ToLower().Replace(" ", "-")">
                    @claim.ClaimStatus
                </td>

                
                <td>
                    <form asp-action="ViewandPreApprove" method="post">
                        <input type="hidden" name="claimId" value="@claim.Claim_Id" />
                        <select name="status" required>
                            <option value="">-- Select --</option>
                            <option value="Pre-Approved">Pre-Approve</option>
                            <option value="Flagged for Review">Flag for Review</option>
                        </select>
                        <button type="submit">Save</button>
                    </form>
                </td>
                <td>
                    <a href="@Url.Action("DownloadClaim", "Users", new { id = claim.Claim_Id })">
                        <button>Download</button>
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>


<footer class="site-footer">
    <p>&copy; 2025 My Website. All rights reserved.</p>
</footer>
