
<link rel="stylesheet" href="~/css/StyleSheet.css" asp-append-version="true" />
@Html.Partial("_NavigationBars")

<div class="pcMessage">
    <h1>Claims Awaiting Final Approval</h1>
    <p>
        The following claims have been reviewed and forwarded by Programme Coordinators.
        As the Academic Manager, you can now give final approval or reject claims that do not meet the required standards.
    </p>

    <div class="back_link">
        <a href="@Url.Action("Academic_Manager", "Users")">
            &larr; Back to Academic Manager Dashboard
        </a>
    </div>
</div>

<table class="View-preApprove" style="border:solid;">
    <thead>
        <tr>
            <th>Claim No</th>
            <th>Lecture Name</th>
            <th>Employee Id</th>
            <th>Module</th>
            <th>Number of Sessions</th>
            <th>Submission Date</th>
            <th>Coordinator Status</th>
            <th>Total Amount</th> 
            <th>Decision</th>
            <th>Document Download</th>
        </tr>
    </thead>

    <tbody>
        <!--used a for each loop to display all the claims submitted-->
        @foreach (var claim in Model)
        {
            <tr>
                <td>@claim.Claim_Id</td>
                <td>@claim.name</td>
                <td>@claim.employeenum</td>
                <td>@claim.module_name</td>
                <td>@claim.number_of_sssions</td>
                <td>@claim.startdate</td>
                <td class="status @claim.ClaimStatus.ToLower().Replace(" ", "-")">@claim.ClaimStatus</td>

               
                <td>@claim.TotalAmount.ToString("R")</td> 
                <!-- This is for Final Approval/Rejection  -->
                <td>
                    <form asp-action="finalApproval" method="post">
                        <input type="hidden" name="claimId" value="@claim.Claim_Id" />
                        <select name="status" required>
                            <option value="">-- Select --</option>
                            <option value="Approved">Approve</option>
                            <option value="Rejected">Reject</option>
                        </select>
                        <button type="submit">Save</button>
                    </form>
                </td>

                <!-- allowing the users to be able to download the document-->
                <td>
                    @if (claim.DocumentData != null && claim.DocumentData.Length > 0)
                    {
                        <a href="@Url.Action("DownloadClaim", "Users", new { id = claim.Claim_Id })" class="btn btn-primary">Download Document</a>
                    }
                    else
                    {
                        <span>No document available</span>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>

<footer class="site-footer">
    <p>&copy; 2025 My Website. All rights reserved.</p>
</footer>
